!function(e){function n(n){for(var a,o,s=n[0],c=n[1],u=n[2],d=0,m=[];d<s.length;d++)o=s[d],Object.prototype.hasOwnProperty.call(r,o)&&r[o]&&m.push(r[o][0]),r[o]=0;for(a in c)Object.prototype.hasOwnProperty.call(c,a)&&(e[a]=c[a]);for(l&&l(n);m.length;)m.shift()();return i.push.apply(i,u||[]),t()}function t(){for(var e,n=0;n<i.length;n++){for(var t=i[n],a=!0,s=1;s<t.length;s++){var c=t[s];0!==r[c]&&(a=!1)}a&&(i.splice(n--,1),e=o(o.s=t[0]))}return e}var a={},r={0:0},i=[];function o(n){if(a[n])return a[n].exports;var t=a[n]={i:n,l:!1,exports:{}};return e[n].call(t.exports,t,t.exports,o),t.l=!0,t.exports}o.m=e,o.c=a,o.d=function(e,n,t){o.o(e,n)||Object.defineProperty(e,n,{enumerable:!0,get:t})},o.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},o.t=function(e,n){if(1&n&&(e=o(e)),8&n)return e;if(4&n&&"object"==typeof e&&e&&e.__esModule)return e;var t=Object.create(null);if(o.r(t),Object.defineProperty(t,"default",{enumerable:!0,value:e}),2&n&&"string"!=typeof e)for(var a in e)o.d(t,a,function(n){return e[n]}.bind(null,a));return t},o.n=function(e){var n=e&&e.__esModule?function(){return e.default}:function(){return e};return o.d(n,"a",n),n},o.o=function(e,n){return Object.prototype.hasOwnProperty.call(e,n)},o.p="";var s=window.webpackJsonp=window.webpackJsonp||[],c=s.push.bind(s);s.push=n,s=s.slice();for(var u=0;u<s.length;u++)n(s[u]);var l=c;i.push([422,1]),t()}({216:function(e,n,t){},422:function(e,n,t){"use strict";t.r(n);var a,r,i,o,s,c,u=t(19),l=t(44),d=t(0),m=t.n(d),f=t(8),p=t.n(f),h=t(54),g=t(207),b=(t(216),t(59),t(22)),v=(t(141),t(82)),y=(t(219),t(83)),E=(t(114),t(41)),w=(t(115),t(66)),k=t(40),I=function(e,n){return Object.defineProperty?Object.defineProperty(e,"raw",{value:n}):e.raw=n,e},C=Object(l.b)(a||(a=I(["\n  {\n    shoppingListItems {\n      _id\n      name\n      checked\n      assignee\n    }\n  }\n"],["\n  {\n    shoppingListItems {\n      _id\n      name\n      checked\n      assignee\n    }\n  }\n"]))),S=Object(l.b)(r||(r=I(["\n  mutation createShoppingListItem($name: String!) {\n    createShoppingListItem(name: $name) {\n      _id\n      name\n      checked\n      assignee\n    }\n  }\n"],["\n  mutation createShoppingListItem($name: String!) {\n    createShoppingListItem(name: $name) {\n      _id\n      name\n      checked\n      assignee\n    }\n  }\n"]))),O=Object(l.b)(i||(i=I(["\n  mutation deleteItem($id: ID!) {\n    deleteShoppingListItem(id: $id)\n  }\n"],["\n  mutation deleteItem($id: ID!) {\n    deleteShoppingListItem(id: $id)\n  }\n"]))),j=Object(l.b)(o||(o=I(["\n  mutation updateItem($id: ID!, $state: Boolean, $assignee: String) {\n    updateShoppingListItem(id: $id, state: $state, assignee: $assignee) {\n      _id\n      name\n      checked\n      assignee\n    }\n  }\n"],["\n  mutation updateItem($id: ID!, $state: Boolean, $assignee: String) {\n    updateShoppingListItem(id: $id, state: $state, assignee: $assignee) {\n      _id\n      name\n      checked\n      assignee\n    }\n  }\n"]))),L=Object(l.b)(s||(s=I(["\n  mutation clearList {\n    clearShoppingList\n  }\n"],["\n  mutation clearList {\n    clearShoppingList\n  }\n"]))),x=Object(l.b)(c||(c=I(["\n  mutation login($username: String!, $password: String!) {\n    login(username: $username, password: $password) {\n      success\n      message\n    }\n  }\n"],["\n  mutation login($username: String!, $password: String!) {\n    login(username: $username, password: $password) {\n      success\n      message\n    }\n  }\n"])));function $(e){var n=Object(d.useState)(""),t=n[0],a=n[1],r=Object(d.useState)(""),i=r[0],o=r[1],s=Object(d.useState)(""),c=s[0],u=s[1],l=Object(k.a)(x,{onCompleted:function(n){n.login.success?(u(""),e.onLoginSuccess()):u(n.login.message)}}),f=l[0],p=l[1].loading,h=""===t||""===i,g=function(){h||f({variables:{username:t,password:i}})};return m.a.createElement(w.a,{justify:"center",align:"middle",style:{height:"100%"}},m.a.createElement(E.a,null,m.a.createElement(y.a,{labelCol:{span:8},wrapperCol:{span:16}},m.a.createElement(y.a.Item,{label:"Nutzername:",required:!0,validateStatus:c?"error":"",hasFeedback:!0},m.a.createElement(v.a,{onChange:function(e){return a(e.target.value)},value:t,onPressEnter:g,disabled:p})),m.a.createElement(y.a.Item,{label:"Kennwort:",required:!0,help:c,validateStatus:c?"error":"",hasFeedback:!0},m.a.createElement(v.a.Password,{onChange:function(e){return o(e.target.value)},value:i,onPressEnter:g,disabled:p})),m.a.createElement(y.a.Item,{wrapperCol:{offset:8,span:16}},m.a.createElement(b.a,{type:"primary",onClick:g,disabled:h||p,loading:p},"Anmelden")))))}t(173);var P=t(102),_=(t(423),t(205)),D=(t(369),t(206)),A=(t(371),t(140)),T=t(109),N=(t(424),t(210)),W=(t(374),t(209)),B=t(425),M=(t(177),t(105)),F=(t(380),t(192)),G=(t(382),t(208));function K(e){var n=Object(d.useState)(e.item.assignee),t=n[0],a=n[1],r=e.assigneeCandidates?function(e){for(var n=new Set,t=[],a=0,r=e;a<r.length;a++){var i=r[a];n.has(i)||(t.push(i),n.add(i))}return t}(e.assigneeCandidates.filter((function(e){return e.startsWith(t)&&""!==e}))):[],i=function(){e.onItemAssigneeChange&&t!==e.item.assignee&&e.onItemAssigneeChange(t)};return m.a.createElement(M.a.Item,{key:e.item._id,style:{textDecoration:e.item.checked?"line-through":"none"}},m.a.createElement(w.a,{style:{width:"100%"}},m.a.createElement(E.a,{span:22},m.a.createElement(G.a,{style:{marginRight:"1em"},checked:e.item.checked,onChange:function(n){return e.onItemCheckedChange(n.target.checked)}}),e.item.name,e.assigneeCandidates&&e.item.assignee?" kauft":"",e.assigneeCandidates&&m.a.createElement(F.a,{defaultActiveFirstOption:!0,value:t,onChange:a,onSelect:i,onInputKeyDown:function(e){13===e.keyCode&&i()},onBlur:i,placeholder:"Wer kauf das?",options:r.map((function(e){return{value:e}})),bordered:!1,size:"small",style:{minWidth:"30%"}})),m.a.createElement(E.a,{span:2},m.a.createElement(b.a,{type:"ghost",style:{border:"0px",padding:0},onClick:e.onItemDeleted,"data-testid":"delete-item-btn",className:"delete-item-btn"},m.a.createElement(B.a,{alt:"Eintrag entfernen"})))))}var q=function(e){return m.a.createElement(M.a,{dataSource:e.shoppingList,renderItem:function(n){return m.a.createElement(K,{item:n,assigneeCandidates:e.assigneeCandidates,onItemCheckedChange:function(t){return e.onItemCheckedChange(n,t)},onItemDeleted:function(){return e.onItemDeleted(n)},onItemAssigneeChange:function(t){e.onItemAssigneeChange&&e.onItemAssigneeChange(n,t)}})}})},z=function(e,n,t,a){return new(t||(t=Promise))((function(r,i){function o(e){try{c(a.next(e))}catch(e){i(e)}}function s(e){try{c(a.throw(e))}catch(e){i(e)}}function c(e){var n;e.done?r(e.value):(n=e.value,n instanceof t?n:new t((function(e){e(n)}))).then(o,s)}c((a=a.apply(e,n||[])).next())}))},J=function(e,n){var t,a,r,i,o={label:0,sent:function(){if(1&r[0])throw r[1];return r[1]},trys:[],ops:[]};return i={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function s(i){return function(s){return function(i){if(t)throw new TypeError("Generator is already executing.");for(;o;)try{if(t=1,a&&(r=2&i[0]?a.return:i[0]?a.throw||((r=a.return)&&r.call(a),0):a.next)&&!(r=r.call(a,i[1])).done)return r;switch(a=0,r&&(i=[2&i[0],r.value]),i[0]){case 0:case 1:r=i;break;case 4:return o.label++,{value:i[1],done:!1};case 5:o.label++,a=i[1],i=[0];continue;case 7:i=o.ops.pop(),o.trys.pop();continue;default:if(!(r=o.trys,(r=r.length>0&&r[r.length-1])||6!==i[0]&&2!==i[0])){o=0;continue}if(3===i[0]&&(!r||i[1]>r[0]&&i[1]<r[3])){o.label=i[1];break}if(6===i[0]&&o.label<r[1]){o.label=r[1],r=i;break}if(r&&o.label<r[2]){o.label=r[2],o.ops.push(i);break}r[2]&&o.ops.pop(),o.trys.pop();continue}i=n.call(e,o)}catch(e){i=[6,e],a=0}finally{t=r=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}([i,s])}}};var H=function(e){var n=this,t=Object(d.useState)(""),a=t[0],r=t[1],i=Object(d.useState)(!1),o=i[0],s=i[1],c=e.shoppingList.map((function(e){return e.assignee})),u=function(){return z(n,void 0,void 0,(function(){return J(this,(function(n){switch(n.label){case 0:return""===a?[2]:(s(!0),[4,e.onCreateNewItem(a)]);case 1:return n.sent(),r(""),s(!1),[2]}}))}))};return m.a.createElement("div",null,m.a.createElement(q,{shoppingList:e.shoppingList,assigneeCandidates:c,onItemAssigneeChange:e.onItemAssigneeChange,onItemCheckedChange:e.onItemCheckedChange,onItemDeleted:e.onItemDeleted}),m.a.createElement(W.a,{offsetBottom:0},m.a.createElement("div",{style:{paddingTop:"10px",paddingBottom:"10px",background:"white",borderTop:"1px solid #f0f0f0"}},m.a.createElement(w.a,{gutter:[16,8]},m.a.createElement(E.a,{xs:24,sm:24,md:15,lg:15,xl:15},m.a.createElement(v.a,{value:a,onChange:function(e){return r(e.target.value)},onPressEnter:u,disabled:o})),m.a.createElement(E.a,{xs:24,sm:24,md:5,lg:5,xl:5},m.a.createElement(b.a,{type:"primary",style:{width:"100%"},disabled:""===a,onClick:u,loading:o},"Hinzufügen")),m.a.createElement(E.a,{xs:24,sm:24,md:4,lg:4,xl:4},m.a.createElement(N.a,{title:"Wollen Sie die Einkaufsliste wirklich leeren?",onConfirm:e.onDeleteAllItems,okText:"Ja",cancelText:"Nein",icon:m.a.createElement(B.a,{style:{color:"#555555"}}),okType:"danger"},m.a.createElement(b.a,{style:{width:"100%"},danger:!0,type:"primary"},"Liste leeren")))))))},R=function(e,n,t,a){return new(t||(t=Promise))((function(r,i){function o(e){try{c(a.next(e))}catch(e){i(e)}}function s(e){try{c(a.throw(e))}catch(e){i(e)}}function c(e){var n;e.done?r(e.value):(n=e.value,n instanceof t?n:new t((function(e){e(n)}))).then(o,s)}c((a=a.apply(e,n||[])).next())}))},Q=function(e,n){var t,a,r,i,o={label:0,sent:function(){if(1&r[0])throw r[1];return r[1]},trys:[],ops:[]};return i={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function s(i){return function(s){return function(i){if(t)throw new TypeError("Generator is already executing.");for(;o;)try{if(t=1,a&&(r=2&i[0]?a.return:i[0]?a.throw||((r=a.return)&&r.call(a),0):a.next)&&!(r=r.call(a,i[1])).done)return r;switch(a=0,r&&(i=[2&i[0],r.value]),i[0]){case 0:case 1:r=i;break;case 4:return o.label++,{value:i[1],done:!1};case 5:o.label++,a=i[1],i=[0];continue;case 7:i=o.ops.pop(),o.trys.pop();continue;default:if(!(r=o.trys,(r=r.length>0&&r[r.length-1])||6!==i[0]&&2!==i[0])){o=0;continue}if(3===i[0]&&(!r||i[1]>r[0]&&i[1]<r[3])){o.label=i[1];break}if(6===i[0]&&o.label<r[1]){o.label=r[1],r=i;break}if(r&&o.label<r[2]){o.label=r[2],o.ops.push(i);break}r[2]&&o.ops.pop(),o.trys.pop();continue}i=n.call(e,o)}catch(e){i=[6,e],a=0}finally{t=r=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}([i,s])}}},U=A.a.TabPane;var V=function(e){var n,t,a,r=this,i=Object(d.useState)([]),o=i[0],s=i[1],c=function(n){e.onAuthenticationError&&n.graphQLErrors.find((function(e){var n;return 401===(null===(n=null==e?void 0:e.extensions)||void 0===n?void 0:n.code)}))?e.onAuthenticationError():D.a.error({message:n.networkError?"Uuups ein Fehler ist aufgetreten...":n.name,description:n.networkError?"Der Server antwortet nicht :(":n.message})},u=Object(k.b)(C,{onError:c,onCompleted:function(e){return s(e.shoppingListItems)},fetchPolicy:"network-only"}).loading,l=Object(k.a)(S,{onError:c,onCompleted:function(e){return s(Object(T.a)((function(n){return n.concat(e.createShoppingListItem)})))}})[0],f=Object(k.a)(j,{onError:c,onCompleted:function(e){return s(Object(T.a)((function(n){return n.map((function(n){return n._id===e.updateShoppingListItem._id?e.updateShoppingListItem:n}))})))}})[0],p=Object(k.a)(O,{onError:c,onCompleted:function(e){return s(Object(T.a)((function(n){return n.filter((function(n){return n._id!==e.deleteShoppingListItem}))})))}})[0],h=Object(k.a)(L,{onError:c,onCompleted:function(){return s([])}})[0],g=function(e,n,t){for(var a=new Map,r=0,i=e;r<i.length;r++){var o=i[r],s=n(o),c=t(o),u=a.get(s);u?u.push(c):a.set(s,[c])}return a}(o,(function(e){return e.assignee}),(function(e){return e})),b=Array.from(g.entries()),v=function(e,n){f({variables:{id:e._id,state:n}})},y=function(e){p({variables:{id:e._id}})},E=Object(d.useState)("main"),w=E[0],I=E[1];return m.a.createElement(_.a,{title:"Einkaufsliste",subTitle:(n=g.get(w)||o,t=n.filter((function(e){return!e.checked})).length,a="main"===w,0===t?a?"Wow... ihr habt alles gekauft.":"Wow... du hast schon alles gekauft.":1===t?a?"Nur noch ein Produkt muss gekauft werden. Ihr schafft das!":"Nur noch ein Produkt muss gekauft werden. Du schaffst das!":a?"Ihr müsst noch "+n.filter((function(e){return!e.checked})).length+" Produkte kaufen.":"Du musst noch "+n.filter((function(e){return!e.checked})).length+" Produkte kaufen.")},m.a.createElement(P.a,{spinning:u,tip:"Wird aktualisiert..."},m.a.createElement(A.a,{defaultActiveKey:"main",activeKey:w,onChange:I},m.a.createElement(U,{tab:"Alle",key:"main"},m.a.createElement(H,{shoppingList:o,onItemAssigneeChange:function(e,n){f({variables:{id:e._id,assignee:n}})},onItemCheckedChange:v,onItemDeleted:y,onDeleteAllItems:function(){return h()},onCreateNewItem:function(e){return R(r,void 0,void 0,(function(){return Q(this,(function(n){switch(n.label){case 0:return[4,l({variables:{name:e}})];case 1:return n.sent(),[2]}}))}))}})),b.map((function(e){var n=e[0],t=e[1];return m.a.createElement(U,{tab:n,key:n},m.a.createElement(q,{shoppingList:t,onItemCheckedChange:v,onItemDeleted:y}))})))))},X=new l.a({uri:"/graphql"});p.a.render(m.a.createElement(m.a.StrictMode,null,m.a.createElement(u.a,{client:X},m.a.createElement(g.a,null,m.a.createElement((function(){var e=Object(d.useState)(document.cookie.includes("SHOPPER_LOGGED_IN=true")),n=e[0],t=e[1],a=Object(h.g)();return m.a.createElement(h.d,null,m.a.createElement(h.b,{path:"/login"},m.a.createElement($,{onLoginSuccess:function(){t(!0),a.replace("/")}})),m.a.createElement(h.b,{path:"/",render:function(e){var a=e.location;return n?m.a.createElement(V,{onAuthenticationError:function(){return t(!1)}}):m.a.createElement(h.a,{to:{pathname:"/login",state:{from:a}}})}}))}),null)))),document.getElementById("root"))}});
//# sourceMappingURL=main.js.map